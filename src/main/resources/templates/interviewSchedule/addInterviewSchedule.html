<!doctype html>
<html lang="en" >
<head >
  <title >Title</title >
  <!-- Required meta tags -->
  <meta charset="utf-8" >
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" >

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" >
</head >
<body >


<div class="container-fluid" >
  Interview Schedule
</div >
<div class="container-fluid" >

  <div class="container" >
    <form action="/interviewSchedule" method="post" >
      <div class="container" >
        <div class="com-6" >
          Total Applicant Count = <span data-th-text="${totalApplicantCount}" id="totalApplicantCount" ></span >
        </div >
        <div class="com-6" >
          <div class="form-row" >Interview Number =
            <select class="form-control" name="interviewNumber" >
              <option value="" >Please select</option >
              <option data-th-each="interviewBoardNumber : ${interviewBoardNumbers}"
                      data-th-value="${interviewBoardNumber}"
                      data-th-text="${interviewBoardNumber.interviewBoardNumber}" ></option >
            </select >
          </div >
        </div >
      </div >
      <table class="table table-striped table-inverse table-responsive" id="interviewSchedule" >
        <thead class="thead-inverse" >
        <tr >
          <th >Date</th >
          <th >Interview Board Name</th >
          <th >Applicant Count</th >
          <th >Remaining Count</th >
          <th >Modify</th >
        </tr >
        </thead >
        <tbody >
        <tr >
          <td ><input type="date" class="form-control" name="interviewScheduleLists[0].date" ></td >
          <td >
            <select class="form-control" name="interviewScheduleLists[0].interviewBoardId" >
              <option value="" >Please select</option >
              <option data-th-each="interviewBordOne : ${interviewBoard}"
                      data-th-value="${interviewBordOne.id}"
                      data-th-text="${interviewBordOne.name}" ></option >
            </select >
          </td >
          <td ><input type="text" id="co0" onkeyup="countFind(this)" class="form-control"
                      name="interviewScheduleLists[0].count" ></td >
          <td ><input type="text" class="form-control" id="rm0" value="" readonly ></td >
          <td >
            <button type="button" onclick="removeScheduleInterview(this)" class="btn btn-danger" >Remove</button >
          </td >
        </tr >
        </tbody >
      </table >
      <div class="form-group col-md-12 col-sm-12 text-center flex-column " >
        <button class="btn btn-info mr-5" type="button" id="newSchedule" >New Schedule</button >
        <button class="btn btn-warning mr-5"
                type="reset" >
          Clear
        </button >
        <button class="btn btn-success" type="submit" >
          <span data-th-text="${'Save'}" ></span >
        </button >
      </div >
    </form >
  </div >
</div >

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous" ></script >
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous" ></script >
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous" ></script >

<script >

    $("#newSchedule").bind("click", function () {
        let rowLength = $('#interviewSchedule tbody > tr').length;
        let html = `<tr>
           <td scope="row"><input type="date" class="form-control" name="interviewScheduleLists[${rowLength}].date"></td>
           <td>
           <select class="form-control" name="interviewScheduleLists[${rowLength}].interviewBoardId">
            <option value="" >Please select</option >
            <option data-th-each="interviewBordOne : ${'${interviewBoard}" data-th-value="${interviewBordOne.id}"  data-th-text="${interviewBordOne.name}'}></option >
          </select >
           </td>
           <td><input type="text" id="co${rowLength}" onkeyup="countFind(this)" class="form-control count" name="interviewScheduleLists[${rowLength}].count"></td>
           <td><input type="text" class="form-control" value="" id="rm${rowLength}" readonly></td>
           <td> <button type="button" onclick="removeScheduleInterview(this)" class="btn btn-danger">Remove</button></td>
          </tr>`
        $('#interviewSchedule > tbody:last-child').append(html);
    });

    function removeScheduleInterview(obj) {
        document.getElementById("interviewSchedule").deleteRow(obj.parentNode.parentNode.rowIndex);
    }

    function countFind(obj) {
        let selectedFiledId = obj.getAttribute('id').slice(2);
        let totalCount = 0;
        $.each($('.count'), function (key, value) {
            console.log(key + ": " + value);
            totalCount += value;
        });
        $(`#rm${selectedFiledId}`).val(totalCount);
    }

</script >

</body >
</html >
